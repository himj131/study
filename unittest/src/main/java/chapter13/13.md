# 13.까다로운 테스트
## 멀티스레드 코드 테스트
- 스레드 통제와 애플리케이션 코드 사이의 중첩을 최소화 하세요
    - 스레드 없이 다량의 코드를 단위테스트 하도록 설계 변경, 남은코드로 스레드에 집중적인 테스트 작성
- 다른 사람의 작업을 믿으세요
    - 오래전에 나온 동시성 유틸리티 클래스 더그리아(Doug Lea) 등을 활용

#### 1.애플리케이션 로직 추출
#### 2.스레드 로직의 테스트 지원을 위해 재설계
#### 3.스레드 로직을 위한 테스트 작성

## 데이터베이스 테스트
### 데이터 문제
- 테스트 코드와 데이터를 분리시키면 특정 테스트가 통과/실패하는 이유를 파악하기 어려워진다.
- 테스트 안에서 데이터를 생성하고 관리할것
- 데이터베이스가 트랙잭션을 지원한다면 테스트마다 트랜잭션을 초기화하고, 테스트가 끝나면 롤백처리
- 통합테스트는 필수이지만 작성과 유지보수가 어렵다.
### controller 를 목처리

### 더 어려운 시나리오들에 대한 테스트 전략
- 관심사를 분리하라 
    - 애플리케이션 로직은 스레드/데이터베이스/기타 문제를 일으킬수 있는 다른 의존성과 분리
- 느리거나 휘발적인 코드를 목으로 대체하여 의존성 끊기
- 필요시 통합테스트를 작성하되, 단순하고 집중적으로 마늘기

