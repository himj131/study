#### 컴퓨터 시스템 하드웨어 구성
 - (좁은의미의)컴퓨터(CPU, 메모리)
 - 외부장치(입출력장치(디스플레이, 키보드등), 저장장치, 네트워크 어댑터)

 #### 시스템 동작시 하드웨어 작업 순회
1. 입력장치나 네트워크 어댑터를 통해 처리요청 받음
2. 메모리에 있는 명령을 읽어 CPU에서 실행후 결과를 다른 메모리 영역에 기록
3. 메모리의 결과를 저장장치에 기록/네트워크를 통해 다른컴퓨터에전송/출력장치로 송출

#### 프로그램 
 - 프로그램이란?  
 위 1-3 작업을 파나의 기능으로 정리한 것
 - 프로그램 종류  
    1. 애플리케이션 : 사용자가 직접사용 ex)오피스
    2. 미들웨어 : 여러 애플리케이션들의 공통 처리를 묶어 애플리케이션 실행을 도움 ex)DB, 웹서버
    3. OS(운영체제) : 하드웨어를 직접 조작하여 애플리케이션이나 미들웨어의 실행에 필요한 기능제공 ex)리눅스, 윈도우  
- 프로그램은 애플리케이션, 미들웨어, OS 세개가 연동되어 동작한다.  


## OS(리눅스)  
- 리눅스의 역할 : 외부장치를 조작  
-  여러가지 프로그램을 프로세스라는 단위로 실행하고, 여러개의 프로세스 동시실행 할 수 있다. 
- 디바이스 드라이버라고 하는 프로그램을 통해 디바이스를 다룬다. 
- 리눅스가 없다면 ..?
    - 개발자가 디바이스 스펙알아야함
    - 리눅스가 없다면 각 디바이스별 조작 개발 필수 -> 비용증가  
    - 멀티프로세스가 동시에 디바이스 조작할경우 이상현상 

#### CPU 모드  
디바이스 드라이버를 통해 디바이스에 접근하지 않고 (해킹등) 직접 디바이스 조작 상황하는 문제를 피하고자 CPU에 있는 기능을 이용하여 프로세스가 직접 하드웨어에 접근하는 것을 차단한. 
- cpu는 커널모드와 사용자 모드 두가지 모드가 있다.  
- 커널 모드로 동작할 때만 디바이스에 접근 할 수 있다.
    - 디바이스 조작외에도 프로세스 관리 시스템, 프로세스 스케줄링, 메모리 관리 시스템
- 디바이스 드라이버는 커널 모드로 동작하고, 프로세스는 사용자 모드로 동작한다.

#### 커널 
- 커널모드에서 동작하는 os의 핵심 부분이 되는 처리를 모아 담당하는 프로그램을 지칭 - 프로세스가 디바이스 드라이버 포함 커널이 제공하는 기능사용시 `'시스템 콜'`이라는 특수 처리를 통해 커널에 요청

## Chapter2. 사용자 모드로 구현되는 기능 
### 시스템 콜 
프로세스는 프로세스 생성이나 하드웨어조작등 커널의 도움이 필요한 경우 시스템 콜을 통해 커널에 처리를 요청함 

- 시스템 콜의 종류 
    -  프로세스 생성, 삭제, 
    - 메모리 확보, 해제
    - 프로세스간 통신(IPC)
    - 네트워크
    - 파일시스템 다루기 
    - 파일 다루기(디바이스 접근)
- CPU 모드 변경, 처리 과정  
    1. cpu의 특수한 명령 실행으로 시스템 콜 호출
    2. cpu에서 인터럽트 이벤트 발생
    3. cpu가 사용자 모드에서 커널모드로 변경되며 요청 처리를 위해 커널 동작
    4. 요청 처리 후 시스템 콜 처리 종료
    5. 사용자 모드로 돌아가 프로세스 계속 진행

- `strace`  : 시스템 콜 추적 정보
    - strace -T : 각종 시스템 콜 처리에 걸린 시간을 마이크로초 단위로 측정
    - strace -tt : 시스템 콜이 호출된 때의 시간을 마이크로초 단위로 표시
    - 언어에 상관 없이 프로그램이 커널에 처리를 요청할 때에는 결국 시스템 콜을 호출한다.  
- `sar`  :  프로세스가 사용자모드와 커널 모드중 어느쪽에서 실행되는지 비율
    - 한줄에 1코어 대응.
    - 사용자 모드에서 프로세스 실행하고 있는 시간의 비율 = %user + %nice
    - cpu코어가 커널 모드에서 시스템 콜 등 처리를 실행하고 있는 시간의 비율 = %system  (이 수치가 클 경우 시스템 콜이 너무 많이 호출되고 있거나 시스템 과부하 상태를 의미)
    - %idle = cpu코어상에 프로세스도, 커널도 움직이고 있지 않은 상태.    

#### 시스템콜의 wrapper함수  
시스템 콜은 고급언어에서는 직접호출이 불가능. 아키텍처에 의존하는 어셈블리 코드를 사용해 호출해야함.
os는 내부적으로 시스템 콜을 호출하는 일만 하는 함수를 제공하는데 이를 시스템 콜 wrapper라고 한다. wrapper함수는 아키텍처별로 존재.

#### 표준 C라이브러리
리눅스에 ISO에 의해 정해진 C언어의 표준 라이브러리가 제공되고있다.
보통은 GNU프로젝트가 제공하는 glibc를 표준 C라이브러리로 사용하고 대부분의 C프로그램은 glibc를 링크하고 있다. 

`ldd` : 프로그램이 어떤 라이브러리를 링크하고 있는지 확인 
(시스템에 의존하고 있는 여러가지 프로그램에 대해 ldd를 싱행해보면 매우 많은 프로그램이 libc에 링크되어 있음을 알 수 있다.)

#### OS가 제공하는 프로그램
- 시스템 초기화 :init
- OS의 동작을 바꿈 : sysctl, nice, sync
- 파일 관련 : touch, mkdir
- 텍스트 데이터 가공 : grep, sort, uniq
- 성능 측정 : sar, iostat
- 컴파일러 : gcc
- 스크립트 언어 실행 환경 : perl, python, ruby
- 셸: bash
- 윈도우 시스템 : X

    
   

 
